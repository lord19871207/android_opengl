#version 300 es

uniform sampler2D sTexture;

uniform float uApertureDiameter;
uniform float uFocalLength;
uniform float uPlaneInFocus;
uniform float uSensorHeight;

in vec2 vTexPosition;

out vec4 outFragColor;

void main() {
    vec4 color = texture(sTexture, vTexPosition);
    float x = abs(  uApertureDiameter * uFocalLength * (uPlaneInFocus - color.a) /
                    (color.a * (uPlaneInFocus - uFocalLength))  );
    outFragColor = vec4(color.rgb, clamp(x / uSensorHeight, 0.0, 1.0));
}
